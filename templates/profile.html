{% extends "base.html" %}

{% block content %}


<main class="bg-image profile-image responsive-img">
<!-- Search Bar-->
    <section>
        <div class="row no-margin">
            <div class= "col m4 offset-m8 search-container hide-on-small-only">
                <form class="search-bar" method="POST" action="{{ url_for('search') }}">
                    <input type="text" name="search" id="search" placeholder="Enter Author, Title or Genre...">
                    <button type="submit"><i class="fas fa-search"></i></button>
                </form>
            </div>
        </div>
    </section>

<!-- Tab Buttons-->
    <div class="tab-container">
            <div class="row">
                <div class="col s12 m10 offset-m1">
                    <div class="tab center-align">
                        <button class="tablinks" onclick="openTab(event, 'books')">My Saved Books</button>
                        <button class="tablinks" onclick="openTab(event, 'reviews')">My Reviews</button>
                        <button class="tablinks" onclick="openTab(event, 'add-review')">Add Review</button>
                        <button class="tablinks" onclick="openTab(event, 'delete')">Delete Profile</button>
                    </div>
                </div>
            </div>

<!-- Tab Content -->
    <div class="row">
        <div class="col s12 m10 offset-m1">
            <div id="books" class="tabcontent">
                {% if saved_books|length > 0 %}
                <ul>
                    {% for saved in saved_books %}
                    <li>

                    </li>
                    {% endfor %}
                </ul>
                {% else %}
                <h3>You have no books saved </h3>
                    <a href="{{ url_for('reviews') }}" class="btn btn-small center-align">
                        Find Books! </a>
            {% endif %}
            
            </div>
        </div>
    </div>

<!-- Display users own reviews-->
    <div class="row">
        <div class="col s12 m10 offset-m1">   
            <div id="reviews" class="tabcontent">
    {% if reviews|length > 0 %} 
                <ul class="profile-reviews">
        {% for review in reviews %}
            
                    <li>
                        <div class="row">
                            <div class="col s12 m3 responsive-img">
                                <img  src="{{ review.cover }}" alt="cover image for {{review.title}}" class="profile-book-cover" >
                                <small><em>{{ review.date_created }}</em></small>
                            </div>    
                            <div class="col s12 m6">
                                <p class="book-info"> <strong class="book-title">{{ review.title }}</strong>
                                <br> {{ review.author }} 
                                <br> Genre: {{ review.genre }} 
                                <br>Published: {{ review.published }}
                                <br> {{ review.rating}}
                                </p>
                       
                                <ul class="collapsible">
                                    <li>
                                        <div class="collapsible-header">Synopsis <i class="fas fa-angle-down"></i></div>
                                        <div class="collapsible-body"> {{ review.synopsis}}</div>
                                    </li>
                                    <li>
                                        <div class="collapsible-header">Review <i class="fas fa-angle-down"></i></div>
                                        <div class="collapsible-body"> {{ review.review }}</div>
                                    </li>

                                    <button data-target="confirm_delete" class="btn-small modal-trigger">Delete</button>
                                    <a href="{{ url_for('edit_review', review_id=review._id) }}" class="btn-small">Edit</a>
                                </ul>
                                        <!-- Confirm Delete Modal-->                            
                                    <div id="confirm_delete" class="modal">
                                        <div class="modal-content">
                                            <h4>Confirm Delete</h4>
                                            <p>Are you sure you want to delete this review?</p>
                                        </div>
                                        <div class="modal-footer">
                                            <button href="#!" class="modal-close btn-small">Cancel</button>
                                            <a href="{{ url_for('delete_review', review_id=review._id) }}" class="btn-small">Delete</a>
                                        </div>
                                    </div>
                            </div>
                        </div>
                   </li> 
        {% endfor %} 
               </ul>
    {% else %}
                <h3>You have no reviews </h3>
                    <a href="{{ url_for('add_review') }}" type="submit" class="btn center-align">
                        Add Review </a>
    {% endif %} 
     
            </div> 
        </div>
    </div>

<!-- Add Review Form -->   
     <div class="row">
        <div class="col s12 m10 offset-m1">
            <div id="add-review" class="tabcontent">
                <div class="row no-margin">
                    <form class="col s12 register" method="POST" action="{{ url_for('add_review') }}">
                        <div class="row">
                            <div class="input-field col s12">
                                <input  id="title" name="title" type="text" class="validate" required>
                                <label  for="title">Title</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <input  id="author" name="author" type="text" class="validate" required>
                                <label  for="author">Author</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <input id="genre" name="genre" type="text" class="validate" required>
                                <label for="genre">Genre</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <input id="published" name="published" type="text" class="validate" required>
                                <label for="published">Published</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <input id="cover" name="cover" type="url" class="validate" required>
                                <label for="cover">Link to Cover Image</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <input id="buy" name="buy" type="url" class="validate" required>
                                <label for="buy">Buy</label>
                            </div>
                        </div>
                        <div class="row">
                            <ul class="collapsible profile-collapsible">
                                <li>
                                    <div class="collapsible-header">Synopsis <i class="fas fa-angle-down"></i></div>
                                    <div class="collapsible-body">
                                        <textarea id="synopsis" name="synopsis" type="text" class="materialize-textarea validate" required></textarea>
                                        <label for="synopsis">Synopsis</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="collapsible-header">Review <i class="fas fa-angle-down"></i></div>
                                    <div class="collapsible-body">
                                        <textarea id="review" name="review" type="text"  class="materialize-textarea validate" required></textarea>
                                        <label for="review">Review</label>
                                    </div>
                                </li>
                            </ul>    
                        </div>

                         <div class="row txt-center">
                            <div class="rating col s6 push-s2 m6 push-m1">
                                <input id="star5" name="star" type="radio" value="&#11088; &#11088; &#11088; &#11088; &#11088;" class="radio-btn hide" />
                                <label for="star5"><i class="fas fa-star"></i></label>
                                <input id="star4" name="star" type="radio" value="&#11088; &#11088; &#11088; &#11088;" class="radio-btn hide" />
                                <label for="star4"><i class="fas fa-star"></i></label>
                                <input id="star3" name="star" type="radio" value="&#11088; &#11088; &#11088;" class="radio-btn hide" />
                                <label for="star3"><i class="fas fa-star"></i></label>
                                <input id="star2" name="star" type="radio" value="&#11088; &#11088;" class="radio-btn hide" />
                                <label for="star2"><i class="fas fa-star"></i></label>
                                <input id="star1" name="star" type="radio" value="&#11088;" class="radio-btn hide" />
                                <label for="star1"><i class="fas fa-star"></i></label>
                                <div class="clear"></div>
                            </div>
                        </div>

                        <div class="row">
                            <button type="submit" class="col s12 m4 offset-m4 btn-small profile-btn">
                                Add Review
                            </button>
                        </div>            
                    </form>
                </div>
            </div>
        </div>
    </div>
     
    <div class="row">
        <div class="col s12 m10 offset-m1">
            <div id="delete" class="tabcontent">
                <h3 class="center-align tab-heading">Delete Profile</h3>
                <button data-target="profile_delete" class="btn-small modal-trigger">Delete Profile</button>   
            </div>
            <div id="profile_delete" class="modal">
                <div class="modal-content">
                    <h4>Confirm Delete</h4>
                    <p>Are you sure you want to delete your profile?</p>
                </div>
                <div class="modal-footer">
                    <button href="#!" class="modal-close btn-small">Cancel</button>
                    <a href="{{ url_for('delete_profile', user_id=user._id) }}" class="btn-small">Delete Profile</a>
                </div>
            </div>
        </div>
    </div>
    </div>

</main>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/profile_script.js') }}"></script>
{% endblock %}